<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Boost калькулятор (прототип)</title>
    <style>
      :root {
        --bg: #0b0f17;
        --panel: #0f1624;
        --panel2: #0c1320;
        --text: #e9eef7;
        --muted: #a8b3c7;
        --line: rgba(255, 255, 255, 0.08);
        --accent: #7c5cff;
        --accent2: #22c55e;
        --danger: #ef4444;
        --shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
        --radius: 16px;
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family:
          ui-sans-serif,
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          Arial,
          "Noto Sans",
          "Helvetica Neue",
          sans-serif;
        color: var(--text);
        background:
          radial-gradient(
            900px 500px at 10% 10%,
            rgba(124, 92, 255, 0.18),
            transparent 60%
          ),
          radial-gradient(
            900px 500px at 90% 30%,
            rgba(34, 197, 94, 0.12),
            transparent 55%
          ),
          var(--bg);
      }

      .wrap {
        max-width: 1100px;
        margin: 0 auto;
        padding: 24px;
      }

      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        margin-bottom: 18px;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
        min-width: 220px;
      }
      .logo {
        width: 38px;
        height: 38px;
        border-radius: 12px;
        background: linear-gradient(
          135deg,
          rgba(124, 92, 255, 1),
          rgba(34, 197, 94, 1)
        );
        box-shadow: var(--shadow);
      }
      .brand h1 {
        font-size: 16px;
        margin: 0;
        line-height: 1.2;
        letter-spacing: 0.2px;
      }
      .brand p {
        margin: 0;
        font-size: 12px;
        color: var(--muted);
      }

      .top-controls {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
        justify-content: flex-end;
      }

      .select {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid var(--line);
        border-radius: 14px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.18);
        width: min(520px, 100%);
      }
      .select label {
        font-size: 12px;
        color: var(--muted);
        white-space: nowrap;
      }
      select {
        width: 100%;
        background: transparent;
        color: var(--text);
        border: 0;
        outline: none;
        font-size: 13px;
        padding: 4px 0;
        appearance: none;
      }

      .nav {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 14px 0 18px;
      }
      .nav button {
        border: 1px solid var(--line);
        background: rgba(255, 255, 255, 0.03);
        color: var(--text);
        padding: 10px 12px;
        border-radius: 999px;
        cursor: pointer;
        font-size: 13px;
        transition:
          transform 0.08s ease,
          background 0.15s ease,
          border-color 0.15s ease;
      }
      .nav button:hover {
        transform: translateY(-1px);
      }
      .nav button.active {
        background: rgba(124, 92, 255, 0.18);
        border-color: rgba(124, 92, 255, 0.55);
      }

      .grid {
        display: grid;
        grid-template-columns: 1.2fr 0.8fr;
        gap: 14px;
      }

      .card {
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.04),
          rgba(255, 255, 255, 0.02)
        );
        border: 1px solid var(--line);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        overflow: hidden;
      }

      .card-head {
        padding: 16px 16px 12px;
        border-bottom: 1px solid var(--line);
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 10px;
      }
      .card-head h2 {
        margin: 0;
        font-size: 15px;
        letter-spacing: 0.2px;
      }
      .card-head p {
        margin: 6px 0 0;
        font-size: 12px;
        color: var(--muted);
        line-height: 1.35;
        max-width: 70ch;
      }

      .pill {
        font-size: 12px;
        padding: 6px 10px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: rgba(255, 255, 255, 0.03);
        color: var(--muted);
        white-space: nowrap;
        height: fit-content;
      }

      .card-body {
        padding: 16px;
      }

      .form {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 12px;
      }

      .field {
        background: rgba(0, 0, 0, 0.12);
        border: 1px solid var(--line);
        border-radius: 14px;
        padding: 12px;
        min-height: 78px;
      }
      .field.full {
        grid-column: 1 / -1;
      }
      .field .label {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        margin-bottom: 8px;
      }
      .field .label span {
        font-size: 12px;
        color: var(--muted);
      }
      .field .label strong {
        font-size: 12px;
        color: var(--text);
        font-weight: 600;
      }

      input[type="text"],
      input[type="number"] {
        width: 100%;
        border-radius: 12px;
        border: 1px solid var(--line);
        background: rgba(255, 255, 255, 0.03);
        color: var(--text);
        padding: 10px 10px;
        outline: none;
        font-size: 13px;
      }
      input[type="text"]::placeholder,
      input[type="number"]::placeholder {
        color: rgba(168, 179, 199, 0.6);
      }

      .row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }

      .toggle {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }
      .switch {
        position: relative;
        width: 46px;
        height: 26px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid var(--line);
        cursor: pointer;
        flex: 0 0 auto;
      }
      .switch::after {
        content: "";
        position: absolute;
        top: 3px;
        left: 3px;
        width: 20px;
        height: 20px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.75);
        transition:
          transform 0.15s ease,
          background 0.15s ease;
      }
      .switch.on {
        background: rgba(34, 197, 94, 0.18);
        border-color: rgba(34, 197, 94, 0.55);
      }
      .switch.on::after {
        transform: translateX(20px);
        background: rgba(34, 197, 94, 0.9);
      }

      .range {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      input[type="range"] {
        width: 100%;
      }
      .value {
        min-width: 56px;
        text-align: right;
        font-variant-numeric: tabular-nums;
        font-size: 12px;
        color: var(--muted);
      }

      .summary {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .total {
        display: flex;
        align-items: flex-end;
        justify-content: space-between;
        gap: 10px;
        padding: 16px;
        border-radius: var(--radius);
        border: 1px solid var(--line);
        background: rgba(124, 92, 255, 0.1);
      }
      .total .t1 {
        font-size: 12px;
        color: var(--muted);
        margin: 0;
      }
      .total .t2 {
        font-size: 26px;
        margin: 4px 0 0;
        font-weight: 750;
        letter-spacing: 0.2px;
      }
      .total .badge {
        font-size: 12px;
        padding: 6px 10px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid var(--line);
        color: var(--text);
        white-space: nowrap;
      }

      .breakdown {
        padding: 16px;
      }
      .breakdown h3 {
        margin: 0 0 10px;
        font-size: 13px;
        color: var(--text);
      }
      .list {
        display: flex;
        flex-direction: column;
        gap: 8px;
        font-size: 13px;
      }
      .item {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 10px;
        padding: 10px 10px;
        border-radius: 12px;
        border: 1px solid var(--line);
        background: rgba(0, 0, 0, 0.12);
      }
      .item .k {
        color: rgba(233, 238, 247, 0.92);
        font-size: 12px;
        line-height: 1.3;
      }
      .item .v {
        color: var(--muted);
        font-variant-numeric: tabular-nums;
        white-space: nowrap;
        font-size: 12px;
      }
      .item.good .v {
        color: rgba(34, 197, 94, 0.9);
      }
      .item.bad .v {
        color: rgba(239, 68, 68, 0.9);
      }

      .actions {
        display: flex;
        gap: 10px;
        padding: 0 16px 16px;
      }
      .btn {
        width: 100%;
        border-radius: 14px;
        padding: 12px 12px;
        border: 1px solid var(--line);
        background: rgba(255, 255, 255, 0.04);
        color: var(--text);
        cursor: pointer;
        font-size: 13px;
        transition:
          transform 0.08s ease,
          background 0.15s ease,
          border-color 0.15s ease;
      }
      .btn:hover {
        transform: translateY(-1px);
      }
      .btn.primary {
        background: rgba(124, 92, 255, 0.22);
        border-color: rgba(124, 92, 255, 0.55);
      }

      .footnote {
        color: var(--muted);
        font-size: 12px;
        padding: 0 16px 16px;
        line-height: 1.35;
      }

      @media (max-width: 980px) {
        header {
          flex-direction: column;
          align-items: flex-start;
        }
        .top-controls {
          justify-content: stretch;
        }
        .grid {
          grid-template-columns: 1fr;
        }
        .form {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1>Калькулятор буста (прототип)</h1>
            <p>Выбор типа -> форма -> расчет</p>
          </div>
        </div>

        <div class="top-controls">
          <div class="select">
            <label for="serviceSelect">Тип буста</label>
            <select id="serviceSelect"></select>
          </div>
        </div>
      </header>

      <div class="nav" id="nav"></div>

      <div class="grid">
        <section class="card">
          <div class="card-head">
            <div>
              <h2 id="serviceTitle">...</h2>
              <p id="serviceDesc">...</p>
            </div>
            <div class="pill" id="serviceSlug">#...</div>
          </div>
          <div class="card-body">
            <form class="form" id="form"></form>
          </div>
        </section>

        <aside class="summary">
          <div class="total card">
            <div>
              <p class="t1">Итого</p>
              <p class="t2" id="totalPrice">$0</p>
            </div>
            <div class="badge" id="priceMode">Пример ставок</div>
          </div>

          <div class="card breakdown">
            <h3>Разбор цены</h3>
            <div class="list" id="breakdown"></div>
          </div>

          <div class="card">
            <div class="card-body">
              <div class="actions">
                <button class="btn primary" id="copyLink" type="button">
                  Скопировать ссылку
                </button>
                <button class="btn" id="reset" type="button">Сброс</button>
              </div>
              <div class="footnote">
                Примечание: формулы и ставки внутри - заглушки. Но структура уже
                правильная: конфиг -> генерация формы -> правила расчета -> итог
                + детализация.
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>

    <script>
      // --------------------------
      // 1) Описание типов буста + полей (как на твоем списке)
      // --------------------------
      const SERVICES = [
        {
          id: "solo-boost",
          title: "Соло буст",
          desc: "Начальный/конечный MMR + уверенность в рейтинге + переключатели.",
          fields: [
            {
              key: "start_mmr",
              label: "Начальный MMR",
              type: "number",
              placeholder: "например 2500",
            },
            {
              key: "end_mmr",
              label: "Конечный MMR",
              type: "number",
              placeholder: "например 3000",
            },
            {
              key: "confidence",
              label: "Уверенность в рейтинге",
              type: "text",
              placeholder: "например 70%",
            },
            { key: "doubles", label: "Даблы", type: "toggle" },
            { key: "smurfpool", label: "Смурфпулл", type: "toggle" },
            { key: "low_behavior", label: "Лоу порядочность", type: "toggle" },
          ],
        },
        {
          id: "duo-boost",
          title: "Дуо буст",
          desc: "Начальный MMR + количество игр + переключатели + игра на 1/2 позиции.",
          fields: [
            {
              key: "start_mmr",
              label: "Начальный MMR",
              type: "number",
              placeholder: "например 3500",
            },
            {
              key: "games",
              label: "Количество игр",
              type: "number",
              placeholder: "например 10",
            },
            { key: "doubles", label: "Даблы", type: "toggle" },
            { key: "smurfpool", label: "Смурфпулл", type: "toggle" },
            { key: "low_behavior", label: "Лоу порядочность", type: "toggle" },
            { key: "half_role", label: "Игра на 1/2 позиции", type: "toggle" },
          ],
        },
        {
          id: "solo-calib",
          title: "Соло калибровка",
          desc: "Начальный MMR + количество игр + переключатели.",
          fields: [
            {
              key: "start_mmr",
              label: "Начальный MMR",
              type: "number",
              placeholder: "например 2000",
            },
            {
              key: "games",
              label: "Количество игр",
              type: "number",
              placeholder: "например 10",
            },
            { key: "smurfpool", label: "Смурфпулл", type: "toggle" },
            { key: "low_behavior", label: "Лоу порядочность", type: "toggle" },
          ],
        },
        {
          id: "duo-calib",
          title: "Дуо калибровка",
          desc: "Начальный MMR + количество игр + переключатели + игра на 1/2 позиции.",
          fields: [
            {
              key: "start_mmr",
              label: "Начальный MMR",
              type: "number",
              placeholder: "например 3000",
            },
            {
              key: "games",
              label: "Количество игр",
              type: "number",
              placeholder: "например 10",
            },
            { key: "smurfpool", label: "Смурфпулл", type: "toggle" },
            { key: "low_behavior", label: "Лоу порядочность", type: "toggle" },
            { key: "half_role", label: "Игра на 1/2 позиции", type: "toggle" },
          ],
        },
        {
          id: "behavior-boost",
          title: "Буст порядочности",
          desc: "MMR клиента + начальная/конечная порядочность.",
          fields: [
            {
              key: "client_mmr",
              label: "MMR клиента",
              type: "number",
              placeholder: "например 4200",
            },
            {
              key: "start_behavior",
              label: "Начальная порядочность",
              type: "number",
              placeholder: "например 3500",
            },
            {
              key: "end_behavior",
              label: "Конечная порядочность",
              type: "number",
              placeholder: "например 7000",
            },
          ],
        },
        {
          id: "hours-play",
          title: "Отыгрыш часов",
          desc: "Количество часов.",
          fields: [
            {
              key: "hours",
              label: "Количество часов",
              type: "number",
              placeholder: "например 5",
            },
          ],
        },
      ];

      // --------------------------
      // 2) Пример "движка" цены
      //    СТАВКИ И ФОРМУЛЫ - ЗАГЛУШКИ, НО СТРУКТУРА УЖЕ ГОТОВА.
      // --------------------------
      const RATES = {
        // TODO: поменяй на свои реальные ставки
        SOLO_PER_100_MMR: 6, // $ за 100 MMR (пример)
        DUO_PER_GAME: 4, // $ за игру (пример)
        CALIB_PER_GAME: 3.5, // $ за игру (пример)
        BEHAVIOR_PER_1000: 2.5, // $ за 1000 порядочности (пример)
        HOURS_PER_HOUR: 2.0, // $ за час (пример)
      };

      // Надбавки (пример)
      const MODIFIERS = {
        // Смурфпулл +20%
        smurfpool: (base) => ({ label: "Смурфпулл", amount: base * 0.2 }),

        // Лоу порядочность +15%
        low_behavior: (base) => ({
          label: "Лоу порядочность",
          amount: base * 0.15,
        }),

        // 1/2 позиция +10%
        half_role: (base) => ({
          label: "Игра на 1/2 позиции",
          amount: base * 0.1,
        }),

        // Даблы: пример, основанный на твоей фразе:
        // "с даблами 3к ммр будет +50% от базовой цены, 5500+mmr +30% до цены за даблы"
        // Интерпретация в этом прототипе:
        // - базовая надбавка за даблы = base * (mmr >= 3000 ? 0.50 : 0.30)
        // - если mmr >= 5500: увеличиваем именно надбавку за даблы на +30% (то есть * 1.30)
        doubles: (base, mmr) => {
          if (!mmr) return { label: "Даблы", amount: base * 0.3 };
          let addon = base * (mmr >= 3000 ? 0.5 : 0.3);
          if (mmr >= 5500) addon = addon * 1.3;
          return { label: "Даблы", amount: addon };
        },
      };

      function money(n) {
        const x = Number.isFinite(n) ? n : 0;
        return "$" + x.toFixed(2);
      }

      function toNum(v) {
        const n = Number(v);
        return Number.isFinite(n) ? n : 0;
      }

      // По service.id выбираем, как считать base
      function calcBase(serviceId, s) {
        if (serviceId === "solo-boost") {
          const diff = Math.max(0, toNum(s.end_mmr) - toNum(s.start_mmr));
          return (diff / 100) * RATES.SOLO_PER_100_MMR;
        }
        if (serviceId === "duo-boost") {
          return Math.max(0, toNum(s.games)) * RATES.DUO_PER_GAME;
        }
        if (serviceId === "solo-calib" || serviceId === "duo-calib") {
          return Math.max(0, toNum(s.games)) * RATES.CALIB_PER_GAME;
        }
        if (serviceId === "behavior-boost") {
          const diff = Math.max(
            0,
            toNum(s.end_behavior) - toNum(s.start_behavior),
          );
          return (diff / 1000) * RATES.BEHAVIOR_PER_1000;
        }
        if (serviceId === "hours-play") {
          return Math.max(0, toNum(s.hours)) * RATES.HOURS_PER_HOUR;
        }
        return 0;
      }

      function calc(serviceId, s) {
        const base = calcBase(serviceId, s);
        const items = [];

        items.push({ label: "Базовая цена", amount: base, kind: "base" });

        // Пример: надбавки зависят от переключателей
        // Для doubles нужен MMR: берём max(start_mmr, end_mmr, client_mmr) если есть
        const mmrRef = Math.max(
          toNum(s.start_mmr),
          toNum(s.end_mmr),
          toNum(s.client_mmr),
        );

        if (s.doubles)
          items.push({ ...MODIFIERS.doubles(base, mmrRef), kind: "plus" });
        if (s.smurfpool)
          items.push({ ...MODIFIERS.smurfpool(base), kind: "plus" });
        if (s.low_behavior)
          items.push({ ...MODIFIERS.low_behavior(base), kind: "plus" });
        if (s.half_role)
          items.push({ ...MODIFIERS.half_role(base), kind: "plus" });

        const total = items.reduce((acc, it) => acc + it.amount, 0);

        return { base, items, total };
      }

      // --------------------------
      // 3) UI: навигация + генерация формы
      // --------------------------
      const elSelect = document.getElementById("serviceSelect");
      const elNav = document.getElementById("nav");
      const elForm = document.getElementById("form");

      const elTitle = document.getElementById("serviceTitle");
      const elDesc = document.getElementById("serviceDesc");
      const elSlug = document.getElementById("serviceSlug");

      const elTotal = document.getElementById("totalPrice");
      const elBreakdown = document.getElementById("breakdown");

      const elCopyLink = document.getElementById("copyLink");
      const elReset = document.getElementById("reset");

      let currentServiceId = SERVICES[0].id;
      let stateByService = {}; // serviceId -> values

      function defaultStateFor(service) {
        const s = {};
        for (const f of service.fields) {
          if (f.type === "toggle") s[f.key] = false;
          else s[f.key] = "";
        }
        return s;
      }

      function ensureState(serviceId) {
        if (!stateByService[serviceId]) {
          const service = SERVICES.find((x) => x.id === serviceId);
          stateByService[serviceId] = defaultStateFor(service);
        }
        return stateByService[serviceId];
      }

      function setHash(serviceId) {
        const hash = "#" + serviceId;
        if (location.hash !== hash) location.hash = hash;
      }

      function readHash() {
        const raw = (location.hash || "").replace("#", "").trim();
        if (!raw) return null;
        return SERVICES.some((s) => s.id === raw) ? raw : null;
      }

      function renderTop() {
        // select
        elSelect.innerHTML = SERVICES.map(
          (s) => `<option value="${s.id}">${s.title}</option>`,
        ).join("");
        elSelect.value = currentServiceId;

        // nav
        elNav.innerHTML = "";
        for (const s of SERVICES) {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.textContent = s.title;
          btn.dataset.id = s.id;
          if (s.id === currentServiceId) btn.classList.add("active");
          btn.addEventListener("click", () => {
            currentServiceId = s.id;
            setHash(currentServiceId);
            renderAll();
          });
          elNav.appendChild(btn);
        }
      }

      function fieldNode(serviceId, f, s) {
        const wrap = document.createElement("div");
        wrap.className = "field" + (f.full ? " full" : "");

        const label = document.createElement("div");
        label.className = "label";
        label.innerHTML = `<span>${f.label}</span><strong>${f.type === "toggle" ? (s[f.key] ? "Вкл" : "Выкл") : ""}</strong>`;
        wrap.appendChild(label);

        if (f.type === "text" || f.type === "number") {
          const inp = document.createElement("input");
          inp.type = f.type;
          inp.inputMode = f.type === "number" ? "numeric" : "text";
          inp.placeholder = f.placeholder || "";
          inp.value = s[f.key] ?? "";
          inp.addEventListener("input", () => {
            s[f.key] = inp.value;
            update();
          });
          wrap.appendChild(inp);
        }

        if (f.type === "toggle") {
          const row = document.createElement("div");
          row.className = "toggle";

          const left = document.createElement("div");
          left.style.color = "rgba(233,238,247,.92)";
          left.style.fontSize = "13px";
          left.textContent = s[f.key] ? "Да" : "Нет";

          const sw = document.createElement("div");
          sw.className = "switch" + (s[f.key] ? " on" : "");
          sw.role = "switch";
          sw.ariaChecked = String(!!s[f.key]);
          sw.tabIndex = 0;

          function flip() {
            s[f.key] = !s[f.key];
            update();
          }
          sw.addEventListener("click", flip);
          sw.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              flip();
            }
          });

          row.appendChild(left);
          row.appendChild(sw);
          wrap.appendChild(row);
        }

        return wrap;
      }

      function renderForm() {
        const service = SERVICES.find((x) => x.id === currentServiceId);
        const s = ensureState(currentServiceId);

        elTitle.textContent = service.title;
        elDesc.textContent = service.desc;
        elSlug.textContent = "#" + service.id;

        elForm.innerHTML = "";
        for (const f of service.fields) {
          elForm.appendChild(fieldNode(currentServiceId, f, s));
        }
      }

      function renderBreakdown(result) {
        elBreakdown.innerHTML = "";
        for (const it of result.items) {
          const div = document.createElement("div");
          div.className = "item " + (it.kind === "plus" ? "good" : "");
          div.innerHTML = `
          <div class="k">${it.label}</div>
          <div class="v">${money(it.amount)}</div>
        `;
          elBreakdown.appendChild(div);
        }
      }

      function update() {
        // re-render nav active state
        [...elNav.querySelectorAll("button")].forEach((b) => {
          b.classList.toggle("active", b.dataset.id === currentServiceId);
        });
        elSelect.value = currentServiceId;

        // re-render form (чтобы обновлять "Вкл/Выкл" и switch)
        renderForm();

        // calc
        const s = ensureState(currentServiceId);
        const result = calc(currentServiceId, s);

        elTotal.textContent = money(result.total);
        renderBreakdown(result);
      }

      function renderAll() {
        renderTop();
        update();
      }

      // --------------------------
      // 4) Events
      // --------------------------
      elSelect.addEventListener("change", () => {
        currentServiceId = elSelect.value;
        setHash(currentServiceId);
        renderAll();
      });

      window.addEventListener("hashchange", () => {
        const id = readHash();
        if (id && id !== currentServiceId) {
          currentServiceId = id;
          renderAll();
        }
      });

      elCopyLink.addEventListener("click", async () => {
        try {
          const url =
            location.origin + location.pathname + "#" + currentServiceId;
          await navigator.clipboard.writeText(url);
          elCopyLink.textContent = "Ссылка скопирована";
          setTimeout(
            () => (elCopyLink.textContent = "Скопировать ссылку"),
            1200,
          );
        } catch (e) {
          alert("Не получилось скопировать. Ссылка: " + location.href);
        }
      });

      elReset.addEventListener("click", () => {
        const service = SERVICES.find((x) => x.id === currentServiceId);
        stateByService[currentServiceId] = defaultStateFor(service);
        update();
      });

      // --------------------------
      // 5) Init
      // --------------------------
      const fromHash = readHash();
      if (fromHash) currentServiceId = fromHash;
      else setHash(currentServiceId);

      renderAll();
    </script>
  </body>
</html>
